{
  "version": "1.0",
  "frictions": [
    {
      "id": "exec-verbal-2fa",
      "title": "Exec verbal 2FA for top command requests",
      "severity": 0.9,
      "when": "slop_or_borderline",
      "triggers": {
        "risk_tags_any": ["financial", "legal", "operations", "gold_app"]
      },
      "steps": [
        "Perform callback to a known good phone number from the corporate directory",
        "Issue a one time 6 digit verbal code over a separate channel",
        "Require a ticket ID or legal matter number and cross reference",
        "Require two person approval with named approvers"
      ],
      "rationale": "Mitigates deepfake or LLM amplified spoofing for high impact decisions"
    },
    {
      "id": "two-independent-sources",
      "title": "Require two independent primary sources",
      "severity": 0.7,
      "when": "slop_or_borderline",
      "triggers": {
        "rule_ids_any": ["source-free", "llm-only-claims"]
      },
      "steps": [
        "Obtain a vendor advisory or PSIRT note",
        "Check CISA KEV or NVD entry for the CVE if applicable",
        "Collect an operator report or forensic artifact from inside the environment"
      ],
      "rationale": "Reduces reliance on uncorroborated claims"
    },
    {
      "id": "ioc-triangulation",
      "title": "Triangulate indicators before blocking",
      "severity": 0.65,
      "when": "always",
      "triggers": {
        "rule_ids_any": ["ioc-format", "hash-length"],
        "risk_tags_any": ["operations"]
      },
      "steps": [
        "Enrich IOCs with at least two sources such as VirusTotal, GreyNoise, AbuseIPDB",
        "Verify IP ranges and ASN ownership",
        "Stage blocks behind a feature flag and observe telemetry for 30 minutes"
      ],
      "rationale": "Avoids collateral damage from malformed or stale IOCs"
    },
    {
      "id": "lab-reproduction",
      "title": "Reproduce claims in a lab",
      "severity": 0.8,
      "when": "slop_or_borderline",
      "triggers": {
        "rule_ids_any": ["cve-format", "mitre-format", "llm-only-claims"]
      },
      "steps": [
        "Use an isolated VM or container with no egress",
        "Attempt to replicate the exploit or behavior with safe test artifacts",
        "Capture logs and packet traces as evidence"
      ],
      "rationale": "Validates technical feasibility before production changes"
    },
    {
      "id": "cooldown-and-peer-review",
      "title": "Cooldown and second reviewer for production-impacting actions",
      "severity": 0.75,
      "when": "slop_or_borderline",
      "triggers": {
        "risk_tags_any": ["operations", "gold_app"]
      },
      "steps": [
        "Impose a minimum 30 minute hold unless a critical incident is declared",
        "Require a second reviewer who is outside the requestor chain",
        "Document rollback plan and success metrics"
      ],
      "rationale": "Prevents rushed operational mistakes"
    },
    {
      "id": "no-paste-to-prod",
      "title": "Do not paste model output into prod systems",
      "severity": 0.85,
      "when": "always",
      "triggers": {
        "risk_tags_any": ["operations"]
      },
      "steps": [
        "Route all commands through change control or automation",
        "Require a dry run in staging with logs attached",
        "Use signed runbooks with hash pinning"
      ],
      "rationale": "Prevents prompt injection from becoming command injection"
    },
    {
      "id": "finance-approval",
      "title": "Finance approval for monetary moves",
      "severity": 0.9,
      "when": "slop_or_borderline",
      "triggers": {
        "risk_tags_any": ["financial"]
      },
      "steps": [
        "Require CFO or delegate approval logged in the ticket",
        "Authenticate approver with step up MFA",
        "Verify beneficiary details using a pre-approved vendor profile"
      ],
      "rationale": "Prevents business email compromise style losses"
    },
    {
      "id": "legal-counsel-ack",
      "title": "Legal counsel acknowledgment",
      "severity": 0.8,
      "when": "slop_or_borderline",
      "triggers": {
        "risk_tags_any": ["legal"]
      },
      "steps": [
        "Obtain counsel sign off that action aligns with policy and regulation",
        "Record matter number and retention requirements",
        "Label communications with appropriate TLP"
      ],
      "rationale": "Reduces legal exposure from hasty actions"
    },
    {
      "id": "identity-stepup",
      "title": "Step up authentication for identity changes",
      "severity": 0.7,
      "when": "always",
      "triggers": {
        "risk_tags_any": ["operations", "gold_app"]
      },
      "steps": [
        "Require Okta or IdP step up auth for privilege changes",
        "Confirm request against HR roster and on call schedule",
        "Log who approved the change and when"
      ],
      "rationale": "Hardens identity plane against social engineering"
    },
    {
      "id": "canary-change",
      "title": "Canary first then expand",
      "severity": 0.6,
      "when": "always",
      "triggers": {
        "risk_tags_any": ["operations", "gold_app"]
      },
      "steps": [
        "Apply the change to 1 percent of scope",
        "Monitor errors and business KPIs for a full cycle",
        "Only then expand to 10 percent then 100 percent if clean"
      ],
      "rationale": "Avoids wide blast radius from wrong moves"
    },
    {
      "id": "cve-verify",
      "title": "Verify CVE claims",
      "severity": 0.65,
      "when": "always",
      "triggers": {
        "rule_ids_any": ["cve-format"]
      },
      "steps": [
        "Check NVD record and vendor advisory",
        "Confirm affected versions match your environment",
        "Capture patch or mitigation notes before action"
      ],
      "rationale": "Prevents chasing ghost CVEs"
    }
  ]
}
